
<% include header.ejs %>
<main class="main-content bgc-grey-100">
  <div id="mainContent">
    <div class="container-fluid">
      <div class="row">
        <div class="col-md-12">
          <div class="bgc-white bd bdrs-3 p-20 mB-20">
            <h4 class="c-grey-900 mB-20">Messages List</h4>
            <table id="dataTable" class="table table-striped table-bordered" cellspacing="0" width="100%">
              <thead>
                <tr>
                  <th>Message</th>
                  <th>Media</th>
                  <th>Media actions</th>
                  <th>isGroup</th>
                  <th>From</th>
                  <th>To</th>
                  <th>Date</th>
                </tr>
              </thead>

              <tbody>


                <%
            
          <% for (var i = 0; i < messages.messages_list.length; i++) { %>
            <tr>
                <td class="mdl-data-table__cell--non-numeric" style="word-break:break-all;">
                  <%    if (messages.messages_list[i].message != null) { if (messages.messages_list[i].message == '0x0i3del0x0') {%>
                    <center><label class="label label-success" style="font-size: medium">A user is created this group </label></center>
                    <%   } else if (messages.messages_list[i].message == '0x0i5ela0x0') {%>
                      <center><label class="label label-danger" style="font-size: medium">A user is left this group </label></center>
                      <%   } else {%>
                        <center>
                          <div>' . $message . '</div>
                        </center>
                        <%   }
                } else%>
  
                          <center> <label class="label label-warning" style="font-size: medium"> Empty message </label></center>
                </td>
                <td>
                  <%  if (messages.messages_list[i].image != null && messages.messages_list[i].image  != "null") { %>
                    <center><img style="width: 100px ;height: 100px" alt="User Image" src="../api/v1/files/image/messageImage/<?php echo $fetch['imageFile']; ?>">
                    </center>
                    <%
                } else if (messages.messages_list[i].video  != null && messages.messages_list[i].video != "null") {
                          %>
                      <video style="width: 100px ;height: 100px" src="../api/v1/files/video/messageVideo/<?php echo $fetch['videoFile']; ?>" controls poster="../api/v1/files/video/messageVideoThumbnail/<?php echo $fetch['thumbnailFile']; ?>">
                          </video>
  
                      <% } else
                          if (messages.messages_list[i].document  != null && messages.messages_list[i].document  != "null") {
                              %>
                        <center>
                          <object class="ben-cherif-data--image ">
                                      <embed src="../api/v1/files/document/messageDocument/<?php echo $fetch['documentFile']; ?>"> document</embed>
                                  </object>
  
                        </center>
                        <%
                      } else if (messages.messages_list[i].audio  != null && messages.messages_list[i].audio  != "null") {
                              %>
                          <center>
                            <audio controls>
                                      <source src="../api/v1/files/audio/messageAudio/<?php echo $fetch['audioFile']; ?>"
                                              type="audio/mpeg">
  
                                  </audio>
                          </center>
                          <%
                        } else {%>
                            <center> <label class="label label-warning" style="font-size: medium">
                   No media </label></center>
                            <%  }%>
                </td>
                <td>
                  <%  if (messages.messages_list[i].image  != null && messages.messages_list[i].image  != "null") {%>
                    <center><a type="button" href="../api/v1/files/image/messageImage/' . $fetch['imageFile'] . '" class="btn btn-block btn-success" download> Download </a> </center>
                    <%} else if (messages.messages_list[i].video  != null && messages.messages_list[i].video  != "null") {%>
                      <center><a type="button" href="../api/v1/files/video/messageVideo/' . $fetch['videoFile'] . '" class="btn btn-block btn-success" download> Download </a> </center>
                      <%  } else if (messages.messages_list[i].document  != null && messages.messages_list[i].document  != "null") {%>
                        <center><a type="button" href="../api/v1/files/document/messageDocument/' . $fetch['documentFile'] . '" class="btn btn-block btn-success" download> Download </a> </center>
                        <%  } else if (messages.messages_list[i].audio  != null && messages.messages_list[i].audio  != "null") {%>
                          <center><a type="button" href="../api/v1/files/audio/messageAudio/' . $fetch['audioFile'] . '" class="btn btn-block btn-success" download> Download </a> </center>
                          <%  }%>
                </td>
                <td>
                  <% if (messages.messages_list[i].groupId !=0 ) {%>
                    <center> <label class="label label-success" style="font-size: medium"> True</label></center>
                    <%  } else {%>
                      <center> <label class="label label-danger" style="font-size: medium">
                  False</label></center>
                      <%  }%>
                </td>
                <td style="word-break:break-all;">
                  <center>
                    <div>
                      <%= messages.messages_list[i].sender  %>
                    </div>
                  </center>
                </td>
                <td style="word-break:break-all;">
                  <center>
                    <div>
                      <%= messages.messages_list[i].recipient  %>
                    </div>
                  </center>
                </td>
                <td style="word-break:break-all;">
                  <center>
                    <div>' . date("F d , Y , g:i a", strtotime($date)) . '</div>
                  </center>
                </td>
                </tr>
                <%  } %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>
<% include footer.ejs %>